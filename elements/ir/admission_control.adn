internal {
	last: int
	window: int
	failure: int // timestamp here 
	total: int
}

fn init(window) {
	window := 5;
}

fn req(rpc_req) {
	now := current_time();
	match(now - last > window) {
		true => {
			failure := 0;
			total := 0;
			last := now;
		}
		false => {
			// do nothing
		}
	}; 
	match(failure > 0.5 * total) {
		true => {
			send(err('admission_control'), APP);
		}
		false => {
			total := total + 1;
			send(rpc_req, NET);
		}
	};
}

fn resp(rpc_resp) {
	match(rpc_resp) {
		Some(rpc_resp) => {
			send(rpc_resp, APP);
		}
		Some(err(msg)) => {
			failure := failure + 1;
			send(err(msg), APP);
		}
	};
}